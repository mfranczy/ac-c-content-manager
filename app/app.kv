#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import NoTransition kivy.uix.screenmanager.NoTransition

<SettingsScreen>:
	name: "settings"
    MDBoxLayout:
    	orientation: "vertical"
    	md_bg_color: get_color_from_hex("#ffffff")
    	padding: ("300dp", "100dp")
    	spacing: "50dp"

    	MDLabel:
    		halign: "center"
    		id: settings_label
    		text: "Settings"
    		theme_text_color: "Custom"
		    text_color: get_color_from_hex("#333333")
		    height: "30dp"
	
		MDTextField:
			id: generic_server
		    hint_text: "HTTP server address"
		    required: True
		    helper_text: "HTTP server address to connect to"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: generic_user
		    hint_text: "HTTP user (optional)"
		    helper_text: "Created HTTP user to login to the server"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: generic_password
		    hint_text: "HTTP server password (optional)"
		    helper_text: "HTTP server password for the created user"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: ac_skins_dir
		    hint_text: "Assetto Corsa skins directory"
		    helper_text: "Leaving that field empty means AC is not installed"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: acc_skins_dir
		    hint_text: "Assetto Corsa Competizione skins directory"
		    helper_text: "Leaving that field empty means ACC is not installed"
		    helper_text_mode: "on_focus"

		MDBoxLayout:
			spacing: "250dp"
			MDRectangleFlatButton:
			    text: "Cancel"
			    text_color: get_color_from_hex("333333")
			    line_color: get_color_from_hex("333333")
			    on_release: app.close_settings()
			MDRectangleFlatButton:
			    text: "Confirm"
			    text_color: get_color_from_hex("333333")
			    line_color: get_color_from_hex("333333")
			    on_release: root.confirm()

<LoaderScreen>:
	name: "loader"
	MDBoxLayout:
    	md_bg_color: get_color_from_hex("#222222")
    	orientation: "vertical"

    	MDToolbar:
	        title: "Content Manager"
	        md_bg_color: get_color_from_hex("#333333")
	        icon: "git"
	        right_action_items: [["refresh", lambda x: app.custom_dispatcher.do_refresh(x), "Refresh"], ["database", lambda x: app.open_backup(x), "Backup"], ["cog-outline", lambda x: app.open_settings(x), "Settings"]]

	    MDBoxLayout:
	    	md_bg_color: get_color_from_hex("#222222")

	    	MDLabel:
	    		id: loader_label
	    		text: "Loading..."
	    		halign: "center"
	    		theme_text_color: "Custom"
			    text_color: get_color_from_hex("#ffffff")

<ContentScreen>:
	name: "content_screen"

    MDBoxLayout:
    	md_bg_color: get_color_from_hex("#222222")
    	orientation: "vertical"

	    MDToolbar:
	        title: "Content Manager"
	        md_bg_color: get_color_from_hex("#333333")
	        icon: "git"
	        right_action_items: [["cloud-refresh", lambda x: app.custom_dispatcher.do_recreate_all(x), "Recreate all"], ["refresh", lambda x: app.custom_dispatcher.do_refresh(x), "Refresh"], ["database", lambda x:  app.open_backup(x), "Backup"], ["cog-outline", lambda x: app.open_settings(x), "Settings"]]

	    MDBoxLayout:
			orientation: "vertical"

			MDBoxLayout:
				padding: ("24dp", 0)
				height: 60
				size_hint_y: None

				MDBoxLayout:
					id: leagues_buttons
					spacing: "10dp"

				GridLayout:
					cols: 1

					AnchorLayout:
						anchor_x: 'right'
						anchor_y: 'bottom'
		    			adaptive_width: True

						MDRectangleFlatButton:
						    text: "Download all"
						    text_color: get_color_from_hex("#718089")
	    					line_color: get_color_from_hex("#8fce00")
	    					on_release: app.custom_dispatcher.do_download_all()

			ScreenManager:
				id: content_manager
				transition: NoTransition()

<SkinScreen>:
	MDBoxLayout:
		padding: "24dp"
		ScrollView:
			MDList:
				spacing: "12dp"
				cols: 1

<SkinWidget>:
	md_bg_color: get_color_from_hex("#333333")
	padding: "5dp"
	spacing: ["15dp", 0]
	cols: 4
    orientation: "tb-lr"
    size_hint_y: None
    height: 50

	DescriptionLabelWidget:
		size_hint_x: 0.25
		id: "desc_text"
        text: ""
        valign: "center"
        markup: True
        color: get_color_from_hex("#718089")

    PercentageLabelWidget:
    	size_hint_x: 0.05
    	id: "percentage_text"
        text: "0%"
        halign: "center"
        valign: "center"
        color: get_color_from_hex("#718089")

    ProgressBarWidget:
    	size_hint_x: 0.2
    	id: "progress_bar"
    	padding: "10dp"
        value: 0
        color: get_color_from_hex("#ff8000")

	DownloadWidget:
		size_hint: None, None
		id: "download_button"
	    text: "Download"
	    text_color: get_color_from_hex("#718089")
	    line_color: get_color_from_hex("#ff8000")

<BackupScreen>:
	name: "backup"
	MDBoxLayout:
		orientation: "vertical"
		md_bg_color: get_color_from_hex("#ffffff")
		padding: ("10dp", "30dp")
		spacing: "20dp"

		MDLabel:
    		halign: "center"
    		id: backup_label
    		text: "ACC Cars and Liveries Backup:"
    		theme_text_color: "Custom"
		    text_color: get_color_from_hex("#333333")

		GridLayout:
			cols: 3
			padding: "30dp"
			spacing: "25dp"
			
			AnchorLayout:
				anchor_x: 'right'
				anchor_y: 'top'

				MDRectangleFlatButton:
				    text: "Create backup"
				    text_color: get_color_from_hex("333333")
				    line_color: get_color_from_hex("333333")
				    on_release: root.create_backup()

			AnchorLayout:
				anchor_x: 'center'
				anchor_y: 'top'

				MDRectangleFlatButton:
				    text: "Restore backup"
				    text_color: get_color_from_hex("333333")
				    line_color: get_color_from_hex("333333")
				    on_release: root.restore_backup()

			AnchorLayout:
				anchor_x: 'left'
				anchor_y: 'top'

				MDRectangleFlatButton:
				    text: "Clean customs"
				    text_color: get_color_from_hex("333333")
				    line_color: get_color_from_hex("333333")
				    on_release: root.clean_customs()

		AnchorLayout:
			anchor_x: 'center'
			anchor_y: 'top'

			MDRectangleFlatButton:
			    text: "Exit"
			    text_color: get_color_from_hex("333333")
			    line_color: get_color_from_hex("333333")
			    on_release: root.manager.current = 'content'
