#:import get_color_from_hex kivy.utils.get_color_from_hex


<SettingsScreen>:
	name: "settings"
    MDBoxLayout:
    	orientation: "vertical"
    	md_bg_color: get_color_from_hex("#ffffff")
    	padding: ("300dp", "100dp")
    	spacing: "50dp"

    	MDLabel:
    		halign: "center"
    		id: settings_label
    		text: "Settings"
    		theme_text_color: "Custom"
		    text_color: get_color_from_hex("#333333")
		    height: "30dp"
	
		MDTextField:
			id: generic_server
		    hint_text: "HTTP server address"
		    required: True
		    helper_text: "HTTP server address to connect to"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: generic_user
		    hint_text: "HTTP user (optional)"
		    helper_text: "Created HTTP user to login to the server"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: generic_password
		    hint_text: "HTTP server password (optional)"
		    helper_text: "HTTP server password for the created user"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: ac_skins_dir
		    hint_text: "Assetto Corsa skins directory"
		    helper_text: "Leaving that field empty means AC is not installed"
		    helper_text_mode: "on_focus"

		MDTextField:
			id: acc_skins_dir
		    hint_text: "Assetto Corsa Competizione skins directory"
		    helper_text: "Leaving that field empty means ACC is not installed"
		    helper_text_mode: "on_focus"

		MDBoxLayout:
			spacing: "250dp"
			MDRectangleFlatButton:
			    text: "Cancel"
			    text_color: get_color_from_hex("333333")
			    line_color: get_color_from_hex("333333")
			    on_release: app.close_settings()
			MDRectangleFlatButton:
			    text: "Confirm"
			    text_color: get_color_from_hex("333333")
			    line_color: get_color_from_hex("333333")
			    on_release: root.confirm()

<LoaderScreen>:
	name: "loader"
	MDBoxLayout:
    	md_bg_color: get_color_from_hex("#222222")
    	orientation: "vertical"

    	MDToolbar:
	        title: "Content Manager"
	        md_bg_color: get_color_from_hex("#333333")
	        icon: "git"
	        right_action_items: [["refresh", lambda x: app.custom_dispatcher.do_refresh(x), "Refresh"], ["cog-outline", lambda x: app.open_settings(x), "Settings"]]

	    MDBoxLayout:
	    	md_bg_color: get_color_from_hex("#222222")

	    	MDLabel:
	    		id: loader_label
	    		text: "Loading..."
	    		halign: "center"
	    		theme_text_color: "Custom"
			    text_color: get_color_from_hex("#ffffff")

<ContentScreen>:
	name: "content_screen"
    MDBoxLayout:
    	md_bg_color: get_color_from_hex("#222222")
    	orientation: "vertical"

	    MDToolbar:
	        title: "Content Manager"
	        md_bg_color: get_color_from_hex("#333333")
	        icon: "git"
	        right_action_items: [["cloud-refresh", lambda x: app.custom_dispatcher.do_recreate_all(x), "Recreate all"], ["refresh", lambda x: app.custom_dispatcher.do_refresh(x), "Refresh"], ["cog-outline", lambda x: app.open_settings(x), "Settings"]]

	    MDBoxLayout:
			orientation: "vertical"

			MDBoxLayout:
				padding: ("24dp", 0)
				height: 60
				size_hint_y: None

				GridLayout:
					cols: 2

					AnchorLayout:
						anchor_x: 'left'
						anchor_y: 'bottom'
		    			width: 220
		    			size_hint_x: None

						MDRectangleFlatButton:
							id: acc_button
						    text: "Assetto Corsa Competizione"
						    text_color: get_color_from_hex("#ffffff")
	    					line_color: get_color_from_hex("#b2e73b")
	    					on_release:
	    						self.text_color = get_color_from_hex("#ffffff")
	    						self.line_color = get_color_from_hex("#b2e73b")
	    						root.ids.ac_button.text_color = get_color_from_hex("#718089")
	    						root.ids.ac_button.line_color =  get_color_from_hex("#8fce00")
	    						content_manager.current = 'acc'
	                			content_manager.transition.direction = "right"

					AnchorLayout:
						anchor_x: 'left'
						anchor_y: 'bottom'
		    			adaptive_width: True

						MDRectangleFlatButton:
							id: ac_button
						    text: "Assetto Corsa"
						    text_color: get_color_from_hex("#718089")
	    					line_color: get_color_from_hex("#8fce00")
	    					on_release:
	    						self.text_color = get_color_from_hex("#ffffff")
	    						self.line_color = get_color_from_hex("#b2e73b")
	    						root.ids.acc_button.text_color = get_color_from_hex("#718089")
	    						root.ids.acc_button.line_color =  get_color_from_hex("#8fce00")
	    						content_manager.current = 'ac'
	                			content_manager.transition.direction = "left"

				GridLayout:
					cols: 2

					AnchorLayout:
						anchor_x: 'right'
						anchor_y: 'bottom'

					AnchorLayout:
						anchor_x: 'right'
						anchor_y: 'bottom'
		    			adaptive_width: True

						MDRectangleFlatButton:
						    text: "Download all"
						    text_color: get_color_from_hex("#718089")
	    					line_color: get_color_from_hex("#8fce00")
	    					on_release: app.custom_dispatcher.do_download_all()

			ScreenManager:
				id: content_manager

				MDScreen:
					id: acc_screen
					name: 'acc'
					MDBoxLayout:
						padding: "24dp"
						ScrollView:
							MDList:
								id: acc_skins
								spacing: "12dp"
								cols: 1

				MDScreen:
					id: ac_screen
					name: 'ac'
					MDBoxLayout:
						padding: "24dp"
						ScrollView:
							MDList:
								id: ac_skins
								spacing: "12dp"
								cols: 1

<SkinWidget>:
	md_bg_color: get_color_from_hex("#333333")
	padding: "10dp"
	spacing: ["10dp", 0]
	cols: 4
    orientation: "tb-lr"
    size_hint_y: None
    height: 50

	DescriptionLabelWidget:
		size_hint_x: 0.25
		id: "desc_text"
        text: ""
        valign: "center"
        color: get_color_from_hex("#718089")

    PercentageLabelWidget:
    	size_hint_x: 0.05
    	id: "percentage_text"
        text: "0%"
        halign: "center"
        valign: "center"
        color: get_color_from_hex("#718089")

    ProgressBarWidget:
    	size_hint_x: 0.2
    	id: "progress_bar"
    	padding: "10dp"
        value: 0
        color: get_color_from_hex("#ff8000")

	DownloadWidget:
		size_hint: None, None
		id: "download_button"
	    text: "Download"
	    text_color: get_color_from_hex("#718089")
	    line_color: get_color_from_hex("#ff8000")
